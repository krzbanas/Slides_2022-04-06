<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Infrared characterization of malaria-infected red blood cells</title>
    <meta charset="utf-8" />
    <meta name="author" content="Krzysztof Banas  National University of Singapore Singapore Synchrotron Light Source" />
    <script src="SSLS_Slides_02_files/header-attrs/header-attrs.js"></script>
    <link href="SSLS_Slides_02_files/tile-view/tile-view.css" rel="stylesheet" />
    <script src="SSLS_Slides_02_files/tile-view/tile-view.js"></script>
    <link href="SSLS_Slides_02_files/tachyons/tachyons.min.css" rel="stylesheet" />
    <script src="SSLS_Slides_02_files/xaringanExtra-progressBar/progress-bar.js"></script>
    <script src="SSLS_Slides_02_files/htmlwidgets/htmlwidgets.js"></script>
    <script src="SSLS_Slides_02_files/jquery/jquery.min.js"></script>
    <link href="SSLS_Slides_02_files/leaflet/leaflet.css" rel="stylesheet" />
    <script src="SSLS_Slides_02_files/leaflet/leaflet.js"></script>
    <link href="SSLS_Slides_02_files/leafletfix/leafletfix.css" rel="stylesheet" />
    <script src="SSLS_Slides_02_files/proj4/proj4.min.js"></script>
    <script src="SSLS_Slides_02_files/Proj4Leaflet/proj4leaflet.js"></script>
    <link href="SSLS_Slides_02_files/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
    <script src="SSLS_Slides_02_files/leaflet-binding/leaflet.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: left, middle, inverse, title-slide

# Infrared characterization of malaria-infected red blood cells
## or statistically counting erythrocytes
### Krzysztof Banas <br><span style="font-size: 70%;">National University of Singapore<br>Singapore Synchrotron Light Source</span>
### SSLS Seminar <br> <br> Virtual by Zoom App, 7 April 2022 14:00

---

class: inverse, middle, center
# MOTIVATION

&lt;style type="text/css"&gt;
.highlight-last-item &gt; ul &gt; li,
.highlight-last-item &gt; ol &gt; li {
  opacity: 0.5;
}
.highlight-last-item &gt; ul &gt; li:last-of-type,
.highlight-last-item &gt; ol &gt; li:last-of-type {
  opacity: 1;
}
&lt;/style&gt;





<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 128px;
z-index: 0;
background-image: url(img/nus_logo_full-horizontal.jpg);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:1em;right:1em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('div')
          logo.classList = 'xaringan-extra-logo'
          logo.href = null
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>








<style>.xe__progress-bar__container {
  top:0;
  opacity: 1;
  position:absolute;
  right:0;
  left: 0;
}
.xe__progress-bar {
  height: 0.25em;
  background-color: #0051BA;
  width: calc(var(--slide-current) / var(--slide-total) * 100%);
}
.remark-visible .xe__progress-bar {
  animation: xe__progress-bar__wipe 200ms forwards;
  animation-timing-function: cubic-bezier(.86,0,.07,1);
}
@keyframes xe__progress-bar__wipe {
  0% { width: calc(var(--slide-previous) / var(--slide-total) * 100%); }
  100% { width: calc(var(--slide-current) / var(--slide-total) * 100%); }
}</style>





---
class:middle
- bring attention to experiment design

- recall scientific method

- remind about importance of data visualization and checking for normality

- practical application of these remarks for infrared characterization of malaria infected red blood cells

- introduce optically detected photothermal effect spectroscopy


---
class: inverse, middle, center
# SCIENTIFIC METHOD


---
SOME HISTORY

- ancient Greeks (7&lt;sup&gt;th&lt;/sup&gt;-3&lt;sup&gt;rd&lt;/sup&gt; century BC)

--

- early Muslim scientists  (11&lt;sup&gt;th&lt;/sup&gt; century AD)
    - Ibn al-Haytham
    - Abu Rayhan 
    - al-Biruni
    - Ibn Sina

--

- Robert Grosseteste, Roger Bacon, Ockham's razor (13-14&lt;sup&gt;th&lt;/sup&gt; century AD)

--

- Francis Bacon, Rene Descartes, Galileo, Robert Boyle, Isaac Newton (17&lt;sup&gt;th&lt;/sup&gt; century AD)

--

- Karl Popper and Thomas Kuhn (20&lt;sup&gt;th&lt;/sup&gt; century AD)

---
# GUIDELINE

 1. Define a question
 
--

 2. Gather information and resources (observe)
 
--

 3. Form an explanatory hypothesis
 
--

 4. Test the hypothesis by performing an experiment and collecting data in a reproducible manner
 
--

 5. Analyze the data
 
--

 6. Interpret the data and draw conclusions that serve as a starting point for a new hypothesis
 
--

 7. Publish results
 
--

 8. Retest (frequently done by other scientists)



---
# ITERATION

 1. Define a question

 2. Gather information and resources (observe)

 3. **Form an explanatory hypothesis**

 4. **Test the hypothesis by performing an experiment and collecting data in a reproducible manner**

 5. **Analyze the data**

 6. **Interpret the data and draw conclusions that serve as a starting point for a new hypothesis**

 7. Publish results

 8. Retest (frequently done by other scientists)




---
## Other components

.pull-left[

- Replication

- External review

- Data recording and sharing

- Instrumentation (Large Hardon Collider, James Webb Space Telescope, SSLS)
]

.pull-right[  

&lt;img src="img/scientific_method.png" width="623" /&gt;
]


---
class: inverse, middle, center
# NORMAL DATA

---

## Why this is important?

Many statistical tests rely on *assumption of normality*

- one sample t-test

- two sample t-test

- ANOVA

- linear regression

- MRC

- Hierarchical linear modeling


If this assumption is violated the results of these tests become unreliable and we are unable to generalize our findings from the sample data to the overall population with confidence.



---

&lt;img src="img/distributions.png" width="90%" /&gt;



---
## How to check?

- visually

  1. histogram
  
  2. distribution
  
  3. Q-Q plot
  
  4. violin plot
  
- by formal statistical tests

  1. Shapiro-Wilk
  
  2. Kolmogorov-Smirnov (Lilliefors)
  
  3. Jarque-Bera
  
  4. Anderson-Darling
  
  5. Cramer-von Mises
  
  6. Pearson chi-square

---
class: center
## Distributions
&lt;img src="img/qq_plots.png" width="50%" /&gt;


---
class: center
## Q-Q Plot
&lt;img src="img/qq_normality.png" width="60%" /&gt;


---
## What to do if we fail the test?

- transform data

  1. log transformation 
  
  2. square root transformation
  
  3. cube root transformation
  
  4. Box-Cox transformation
  
- according to Central Limit Theorem, no matter what distribution is, the sampling distribution of mean tends to be normal if the sample is large enough (n ≥ 30)  
  
- use statistical tests for not normal distributions (non-parametric tests)



---
class:center
## Log transformation
&lt;img src="img/transformed.png" width="60%" /&gt;



---
class: inverse, middle, center
# DATASAURUS


---
# Warning: DatasauRus
![](img/DinoSequentialSmaller.gif)&lt;!-- --&gt;




---


```r
datasaurus_dozen %&gt;%
  ggplot(aes(x, y, color = dataset)) +
  geom_point(show.legend = FALSE) +
  facet_wrap(~dataset, ncol = 5)+theme_bw()+
 scale_color_d3("category20")
```

![](SSLS_Slides_02_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;



---


```r
knitr::kable(
datasaurus_dozen %&gt;%
  group_by(dataset) %&gt;%
  summarise(across(c(x, y), list(mean = mean, sd = sd)),
    x_y_cor = cor(x, y)))
```



|dataset    |   x_mean|     x_sd|   y_mean|     y_sd|    x_y_cor|
|:----------|--------:|--------:|--------:|--------:|----------:|
|away       | 54.26610| 16.76983| 47.83472| 26.93974| -0.0641284|
|bullseye   | 54.26873| 16.76924| 47.83082| 26.93573| -0.0685864|
|circle     | 54.26732| 16.76001| 47.83772| 26.93004| -0.0683434|
|dino       | 54.26327| 16.76514| 47.83225| 26.93540| -0.0644719|
|dots       | 54.26030| 16.76774| 47.83983| 26.93019| -0.0603414|
|h_lines    | 54.26144| 16.76590| 47.83025| 26.93988| -0.0617148|
|high_lines | 54.26881| 16.76670| 47.83545| 26.94000| -0.0685042|
|slant_down | 54.26785| 16.76676| 47.83590| 26.93610| -0.0689797|
|slant_up   | 54.26588| 16.76885| 47.83150| 26.93861| -0.0686092|
|star       | 54.26734| 16.76896| 47.83955| 26.93027| -0.0629611|
|v_lines    | 54.26993| 16.76996| 47.83699| 26.93768| -0.0694456|
|wide_lines | 54.26692| 16.77000| 47.83160| 26.93790| -0.0665752|
|x_shape    | 54.26015| 16.76996| 47.83972| 26.93000| -0.0655833|


---
# Boxplots
![](img/boxplots.gif)&lt;!-- --&gt;



---
# Boxplots and Violin Plots
![](img/BoxViolinSmaller.gif)&lt;!-- --&gt;




---
class: inverse, middle, center
# RED BLOOD CELLS

---
# Single cell analysis
&lt;img src="img/visual_overview.png" width="2603" /&gt;

---
class: top
# Classic FTIR = diffraction limit


.pull-left[

## Abbe formula

`$$\delta = \frac{0.612 \lambda}{N.A.}$$`
for `\(\lambda\)` = 10 `\(\mu\)`m (1000 cm&lt;sup&gt;-1&lt;/sup&gt;) 

N.A. = 0.4 

`\(\delta\)` = 15.3  `\(\mu\)`m

]


.pull-right[ 
&lt;img src="img/visual_overview.png" width="2603" /&gt;
]

---
class: inverse, middle, center
# OPTIR

---
## HOW IT WORKS

&lt;video width="640" height="480" autoplay loop controls&gt;
&lt;source src="img/OPTIR.mp4" type="video/mp4"&gt;
&lt;/video&gt;

---


## MODES OF EXPERIMENT

## Single spectrum

.pull-left[

- QCL laser sweep

- motorized stage not moving

- absorption bands over QCL bandwidth (1900-900 cm&lt;sup&gt;-1&lt;/sup&gt;)
]

## 
.pull-right[ 
&lt;img src="img/visual_overview.png" width="2603" /&gt;
]

---

## Chemical Imaging - Mapping

.pull-left[

- QCL laser sweep for one position

- motorized stage moving in X and Y

- spatial distribution of intensity for particular band

- ratio of two bands

- RGB composite image for three bands

]


.pull-right[ 
&lt;img src="img/visual_overview.png" width="2603" /&gt;
]



---

## Hyperspectra

.pull-left[

- QCL laser set to one wavenumber (frequency)

- motorized stage moving in X and Y

- another QCL laser sweep for new position

- spatial distribution of intensity for particular band

- tracking bands shifts

]

.pull-right[ 
&lt;img src="img/visual_overview.png" width="2603" /&gt;
]



---
# RESULTS






---
class: inverse, middle, center
# CONCLUSIONS


---
class: highlight-last-item
# Take home message(s)
- scientific method is still valid approach in the research so: 
  1. hypothise 
  2. measure
  3. analyse
  4. repeat!

--

- take care of your data distribution and adequate statistical tests

--

- visualization of data is of utmost importance

--

- do not trust boxplots or summary statistics (mean, SD etc)

--

- single cells infrared characterization is not recommended with classis FTIR microscope due to diffraction limit

--

- novel method (optically detected photothermal effect infrared spectroscopy) is viable alternative 

---
.bg-washed-orange.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt5[
If a man will begin with  certainties, he shall end in doubts; but if he will be content to begin  with doubts, he shall end in certainties.



.tr[
— Francis Bacon (1605) The Advancement of Learning, Book 1, v. 8
]]



---
## DO NOT JUMP TO CONCLUSION (TOO FAST)

.pull-left[
## 
![](img/datasauRus.gif)&lt;!-- --&gt;
]

.pull-right[  
## 
&lt;img src="img/sheep.jpg" width="1200" /&gt;
]



---
class: inverse, middle, center
# THANK YOU !
&lt;style&gt;
.html-widget {
    margin: auto;
}
&lt;/style&gt;

<div id="htmlwidget-19ae7696bbef6f1aad33" style="width:432px;height:504px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-19ae7696bbef6f1aad33">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]}],"setView":[[1.29563,103.77502],17,[]]},"evals":[],"jsHooks":[]}</script>





    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"highlightLines": true,
"highlightStyle": "solarized-dark"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
(function(time) {
  var d2 = function(number) {
    return ('0' + number).slice(-2); // left-pad 0 to minutes/seconds
  },

  time_format = function(total) {
    var secs = Math.abs(total) / 1000;
    var h = Math.floor(secs / 3600);
    var m = Math.floor(secs % 3600 / 60);
    var s = Math.round(secs % 60);
    var res = d2(m) + ':' + d2(s);
    if (h > 0) res = h + ':' + res;
    return res;  // [hh:]mm:ss
  },

  slide_number_div = function(i) {
    return document.getElementsByClassName('remark-slide-number').item(i);
  },

  current_page_number = function(i) {
    return slide_number_div(i).firstChild.textContent;  // text "i / N"
  };

  var timer = document.createElement('span'); timer.id = 'slide-time-left';
  var time_left = time, k = slideshow.getCurrentSlideIndex(),
      last_page_number = current_page_number(k);

  setInterval(function() {
    time_left = time_left - 1000;
    timer.innerHTML = ' ' + time_format(time_left);
    if (time_left < 0) timer.style.color = 'red';
  }, 1000);

  slide_number_div(k).appendChild(timer);

  slideshow.on('showSlide', function(slide) {
    var i = slide.getSlideIndex(), n = current_page_number(i);
    // reset timer when a new slide is shown and the page number is changed
    if (last_page_number !== n) {
      time_left = time; last_page_number = n;
      timer.innerHTML = ' ' + time_format(time); timer.style.color = null;
    }
    slide_number_div(i).appendChild(timer);
  });
})(60000);
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
